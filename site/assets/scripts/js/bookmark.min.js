
var BOOK_o={init__v(){BOOK_o.cache__v(),BOOK_o.history__v(),BOOK_o.listen__v()},cache__v(){SER_o.CACHE__v({sender_o:BOOK_o,recipient_s:"SWO_o"})},CACHE__v(e){BOOK_o.list__v(Array.from(e)),BOOK_o.dragDrop(document.querySelectorAll("#bookmark_content_list > li"))},list__v(e){let o="";e.forEach((e=>{const t=BOOK_o.slot__s(e);o+=`<li draggable="true">${t}</li>`})),document.querySelector("#bookmark_content_list").innerHTML=o},history__v(){const e=JSON.parse(window.localStorage.getItem("bookmark_content_list"));if(e){let o="";e.forEach(((e,t)=>o+=`<li data-at_n="${t}">${e.name_s} [ ${e.date_s} ]</li>`)),document.querySelector("#bookmark_history_list").innerHTML=o}},save__v(){const e=new Set;document.querySelectorAll("#bookmark_content_list > li").forEach((o=>{e.add(`/slots/${o.textContent}.html`)})),SER_o.CACHE__v({recipient_s:"SWO_o",cache_a:e}),BOOK_o.add__v(Array.from(e)),BOOK_o.history__v()},add__v(e){const o=document.querySelector("#bookmark_name").value.replace(/[^a-zA-Z0-9-_]/g,"-");let t=window.localStorage.getItem("bookmark_content_list");const _=JSON.parse(t)||new Array,a=new Date;_.push({name_s:o,list_a:e,date_s:`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`}),window.localStorage.setItem("bookmark_content_list",JSON.stringify(_))},remove__v(e){},display__v(e){if(!e)return;let o=window.localStorage.getItem("bookmark_content_list");const t=JSON.parse(o),_=+e.dataset.at_n;BOOK_o.bookmarkOpen__v(t[_])},bookmarkOpen__v(e){const o=LIB_o.nodeId__o("bookmark_display");LIB_o.nodeId__o("bookmark_document",o).innerHTML=`${e.name_s} [ ${e.date_s} ]`;let t="";e.list_a.forEach((e=>{const o=BOOK_o.slot__s(e);t+=`<li data-slots_s="${e}" class="truncate">${o}`})),LIB_o.nodeId__o("bookmark_labels",o).innerHTML=`<ul>${t}</ul>`,o.classList.toggle("unseen")},bookmarkClose__v(){LIB_o.nodeId__o("bookmark_display").classList.toggle("unseen")},bookmarkLink__v(){const e=new Set;document.querySelectorAll("#bookmark_labels li").forEach((o=>{e.add(""+o.dataset.slot__s)})),console.log(e)},dragDrop(e,o=null){let t;const _={dragstart:e=>{e.target.classList.add("semi_opac"),t=e.target,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.innerHTML)},dragenter:e=>{e.target.classList.add("drag_over")},dragover:e=>(e.preventDefault(),e.dataTransfer.dropEffect="move",!1),dragleave:e=>{e.target.classList.remove("drag_over")},dragend:o=>{o.target.classList.add("full_opac"),e.forEach((e=>{e.classList.remove("drag_over")}))},drop:e=>{if(e.stopPropagation(),t!==e.target){if(o)return o(t,e.target),!1;t.innerHTML=e.target.innerHTML,e.target.innerHTML=e.dataTransfer.getData("text/html")}return!1}};for(const o of e)for(method_s of Object.keys(_))o.addEventListener(method_s,_[method_s],!1)},slot__s:e=>e.slice("/slots/".length,-".html".length),listen__v(){LIB_o.nodeId__o("bookmark_save").addEventListener("click",(e=>{e.preventDefault(),//!!! do not submit form
BOOK_o.save__v()})),LIB_o.nodeId__o("bookmark_refresh").addEventListener("click",(e=>{e.preventDefault(),//!!! do not submit form
BOOK_o.cache__v()})),LIB_o.nodeId__o("bookmark_history_list").addEventListener("click",(e=>{BOOK_o.display__v(e.target.closest("LI"))})),LIB_o.nodeId__o("bookmark_display").addEventListener("click",BOOK_o.bookmarkClose__v),LIB_o.nodeId__o("bookmark_link").addEventListener("click",BOOK_o.bookmarkLink__v)}};BOOK_o.init__v();