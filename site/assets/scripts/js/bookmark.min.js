
var BOOK_o={init__v(){BOOK_o.cache__v(),BOOK_o.history__v(),BOOK_o.listen__v()},cache__v(){SER_o.CACHE__v({sender_o:BOOK_o,recipient_s:"SWO_o"})},CACHE__v(t){BOOK_o.list__v(Array.from(t)),BOOK_o.dragDrop(document.querySelectorAll("#bookmark_content_list > li"))},list__v(t){let e="";t.forEach((t=>{const o=BOOK_o.slot__s(t);e+=`<li draggable="true">${o}</li>`})),document.querySelector("#bookmark_content_list").innerHTML=e},history__v(){const t=JSON.parse(window.localStorage.getItem("bookmark_content_list"));if(t){let e="";t.forEach(((t,o)=>e+=`<li data-at_n="${o}">${t.name_s} [ ${t.date_s} ]</li>`)),document.querySelector("#bookmark_history_list").innerHTML=e}},save__v(){const t=new Set;document.querySelectorAll("#bookmark_content_list > li").forEach((e=>{t.add(`/slots/${e.textContent}.html`)})),SER_o.CACHE__v({recipient_s:"SWO_o",cache_a:t}),BOOK_o.add__v(Array.from(t)),BOOK_o.history__v()},add__v(t){const e=document.querySelector("#bookmark_name").value.replace(/[^a-zA-Z0-9-_]/g,"-");let o=window.localStorage.getItem("bookmark_content_list");const _=JSON.parse(o)||new Array,a=new Date;_.push({name_s:e,list_a:t,date_s:`${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}`}),window.localStorage.setItem("bookmark_content_list",JSON.stringify(_))},remove__v(t){},display__v(t){if(!t)return;let e=window.localStorage.getItem("bookmark_content_list");const o=JSON.parse(e),_=+t.dataset.at_n;BOOK_o.open__v(o[_])},open__v(t){const e=SLOT_o.dialog__o("section_bookmark");LIB_o.id__o("dialog_block_title",e).innerHTML=`${t.name_s} [ ${t.date_s} ]`;let o="";t.list_a.forEach((t=>{const e=BOOK_o.slot__s(t);o+=`<li data-slot_s="${t}">${e}`})),LIB_o.id__o("dialog_block_list",e).innerHTML=o,e.classList.toggle("retract")},close__v(){SLOT_o.dialog__o("section_bookmark").classList.toggle("retract")},linkto__v(){const t=new Set;SLOT_o.dialog__o("section_bookmark").querySelectorAll('[data-id="dialog_block_list"] > li').forEach((e=>{t.add(e.dataset.slot_s.replaceAll("_"," "))})),SER_o.CACHE__v({recipient_s:"SWO_o",cache_a:t}),window.location.reload()},dragDrop(t,e=null){let o;const _={dragstart:t=>{t.target.classList.add("semi_opac"),o=t.target,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/html",t.target.innerHTML)},dragenter:t=>{t.target.classList.add("drag_over")},dragover:t=>(t.preventDefault(),t.dataTransfer.dropEffect="move",!1),dragleave:t=>{t.target.classList.remove("drag_over")},dragend:e=>{e.target.classList.add("full_opac"),t.forEach((t=>{t.classList.remove("drag_over")}))},drop:t=>{if(t.stopPropagation(),o!==t.target){if(e)return e(o,t.target),!1;o.innerHTML=t.target.innerHTML,t.target.innerHTML=t.dataTransfer.getData("text/html")}return!1}};for(const e of t)for(method_s of Object.keys(_))e.addEventListener(method_s,_[method_s],!1)},slot__s:t=>t.slice("/slots/".length,-".html".length),listen__v(){LIB_o.nodeId__o("bookmark_save").addEventListener("click",(t=>{t.preventDefault(),//!!! do not submit form
BOOK_o.save__v()})),LIB_o.nodeId__o("bookmark_refresh").addEventListener("click",(t=>{t.preventDefault(),//!!! do not submit form
BOOK_o.cache__v()})),LIB_o.nodeId__o("bookmark_history_list").addEventListener("click",(t=>{BOOK_o.display__v(t.target.closest("LI"))}));const t=SLOT_o.dialog__o("section_bookmark");t.addEventListener("click",BOOK_o.linkto__v),LIB_o.id__o("close",t).addEventListener("click",BOOK_o.close__v)}};BOOK_o.init__v();